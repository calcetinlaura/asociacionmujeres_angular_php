<div class="flex flex-col-reverse gap-y-8 lg:flex-row lg:gap-x-24 lg:gap-y-0">
  <div class="flex flex-1 justify-between gap-x-4 relative w-full">
    <!-- Columna: Invoice -->
    <div
      class="w-full h-full"
      [class.cursor-pointer]="!!item.invoice_pdf"
      (click)="openPdf('invoice')"
      (keydown)="onPreviewKeydown($event, 'invoice')"
      tabindex="0"
      role="button"
      aria-label="Abrir factura PDF"
    >
      @if (item.invoice_pdf) {
      <div class="relative w-full">
        <object
          [data]="invoicePreviewUrl"
          type="application/pdf"
          width="100%"
          height="350px"
        ></object>

        <!-- Overlay para captar clic/teclado sin interferir con el <object> -->
        <div
          class="absolute top-0 left-0 w-full h-full"
          style="z-index: 10"
          width="100%"
          height="350px"
        ></div>
      </div>
      } @else {
      <img
        appImgBroken
        loading="lazy"
        [src]="'assets/img/factura.png'"
        [alt]="'Dibujo factura'"
        class="w-full"
      />
      }
    </div>

    <!-- Columna: Proof -->
    <div
      class="w-full h-full"
      [class.cursor-pointer]="!!item.proof_pdf"
      (click)="openPdf('proof')"
      (keydown)="onPreviewKeydown($event, 'proof')"
      tabindex="0"
      role="button"
      aria-label="Abrir justificante PDF"
    >
      @if (item.proof_pdf) {
      <div class="relative w-full">
        <object
          [data]="proofPreviewUrl"
          type="application/pdf"
          width="100%"
          height="350px"
        ></object>

        <!-- Overlay para captar clic/teclado sin interferir con el <object> -->
        <div
          class="absolute top-0 left-0 w-full h-full"
          style="z-index: 10"
          width="100%"
          height="350px"
        ></div>
      </div>
      } @else {
      <img
        appImgBroken
        loading="lazy"
        [src]="'assets/img/factura.png'"
        [alt]="'Dibujo justificante'"
        class="w-full"
      />
      }
    </div>
  </div>

  <div class="flex flex-1 flex-col gap-y-4">
    <div
      class="text-center inline-block border-b border-[#1C1C3A] pb-4 mb-4 md:pb-4 md:mb-8"
    >
      <app-text-title [text]="item.creditor_company" />
      <div class="flex gap-4 justify-center items-center">
        <app-type-invoice-badge [value]="item.type_invoice" />
        @if (item.number_invoice) {
        <app-text-subtitle [text]="item.number_invoice" />
        }
      </div>
    </div>

    @if (item.date_invoice) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Fecha movimiento
      </div>

      <app-text-background
        [text]="item.date_invoice | date : 'dd MMM yyyy'"
        colorBack="#bed8f7"
      ></app-text-background>
    </div>

    } @if (item.date_accounting) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Fecha cuaderno contabilidad
      </div>

      <app-text-background
        [text]="item.date_accounting | date : 'dd MMM yyyy'"
        colorBack="#bed8f7"
      ></app-text-background>
    </div>

    }@if (item.date_payment) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Fecha de pago
      </div>

      <app-text-background
        [text]="item.date_payment | date : 'dd MMM yyyy'"
        colorBack="#bed8f7"
      ></app-text-background>
    </div>

    } @if (item.concept) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Concepto
      </div>
      <div class="flex-1">
        <app-text-background
          [text]="item.concept"
          colorBack="#bed8f7"
        ></app-text-background>
        @if (item.description) {
        <p
          class="pt-4 text-[11px]"
          [innerHTML]="item.description | safeHtml"
        ></p>
        }
      </div>
    </div>
    }@if (item.creditor_contact) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Acreedor
      </div>
      <div class="flex-1">
        <app-text-background
          [text]="item.creditor_contact"
          colorBack="#bed8f7"
        ></app-text-background>
        @if (item.creditor_id) {
        <p
          class="pt-4 text-[11px]"
          [innerHTML]="item.creditor_cif | safeHtml"
        ></p>
        }
      </div>
    </div>
    }@if (item.subsidy_name) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Subvenci√≥n
      </div>
      <div class="flex-1">
        <app-text-background
          [text]="item.subsidy_name"
          colorBack="#bed8f7"
        ></app-text-background>
      </div>
    </div>
    }@if (item.project_title) {
    <div class="flex">
      <div
        class="border-r-[1px] border-lilaOscuro w-[80px] md:w-[120px] text-[10px] flex justify-start items-center mr-4"
      >
        Proyecto
      </div>
      <div class="flex-1">
        <app-text-background
          [text]="item.project_title"
          colorBack="#bed8f7"
        ></app-text-background>
      </div>
    </div>
    }
    <div class="flex flex-row gap-4 align-middle">
      @if (item.amount) {
      <div
        class="flex flex-1 flex-col items-center justify-center text-[9px] md:text-[12px] px-[6px] py-3 rounded-[4px] border-[1px] border-lilaClaro"
      >
        <p>(BASE)</p>
        <p>{{ item.amount | eurosFormat }}</p>
      </div>
      } @if (item.iva) {
      <div
        class="flex flex-1 flex-col items-center justify-center text-[9px] md:text-[12px] px-[6px] pt-1 pb-[3px] rounded-[4px] border-[1px] border-lilaClaro"
      >
        <p>(IVA)</p>
        <p>{{ item.iva | eurosFormat }}</p>
      </div>
      } @if (item.irpf) {
      <div
        class="flex flex-1 flex-col items-center justify-center text-[9px] md:text-[12px] px-[6px] pt-1 pb-[3px] rounded-[4px] border-[1px] border-lilaClaro"
      >
        <p>(IRPF)</p>
        <p>{{ item.irpf | eurosFormat }}</p>
      </div>
      } @if (item.total_amount) {
      <div
        class="flex flex-1 flex-col items-center justify-center text-[9px] md:text-[12px] px-[6px] pt-1 pb-[3px] rounded-[4px] border-[1px] border-lilaClaro"
      >
        <p>(TOTAL)</p>
        {{ item.total_amount | eurosFormat }}
      </div>
      }
    </div>
  </div>
</div>
